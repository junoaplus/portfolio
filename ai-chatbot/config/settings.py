"""
ν™κ²½μ„¤μ • λ° μ „μ—­ μƒμ κ΄€λ¦¬
- ν™κ²½λ³€μ λ΅λ“
- API μ—”λ“ν¬μΈνΈ μ •μ
- μ™„μ„±λ νμ΄μ§€ λ©λ΅ κ΄€λ¦¬
"""

import os
from typing import List, Dict, Any
from dotenv import load_dotenv

# .env νμΌ λ΅λ“
load_dotenv()

class Config:
    # === ν™κ²½λ³€μ ===
    OPENAI_API_KEY: str = os.getenv("OPENAI_API_KEY")
    PORTFOLIO_BASE_URL: str = os.getenv("PORTFOLIO_API_BASE_URL", "http://localhost:3000")
    
    # === API μ„¤μ • ===
    PORTFOLIO_API_BASE_URL: str = f"{PORTFOLIO_BASE_URL}/api/portfolio"
    REQUEST_TIMEOUT: int = 30
    MAX_RETRIES: int = 3
    
    # === OpenAI μ„¤μ • ===
    OPENAI_MODEL: str = "gpt-4o-mini"
    OPENAI_TEMPERATURE: float = 0.7
    OPENAI_MAX_TOKENS: int = 2000
    
    # === μ™„μ„±λ νμ΄μ§€ λ©λ΅ (λ™μ  λ°μ΄ν„° μ¶”μ¶ κ°€λ¥) ===
    COMPLETE_PROJECTS: List[str] = [
        "boardgame-chatbot",    # λ³΄λ“κ²μ„ μ±—λ΄‡ (μƒμ„Ένμ΄μ§€ μ™„μ„±)
        "date-recommendation",  # λ°μ΄νΈ μ½”μ¤ AI (μƒμ„Ένμ΄μ§€ μ™„μ„±)
        "newspaper-churn",      # μ‹ λ¬Έ μ΄νƒ μμΈ΅ (μƒμ„Ένμ΄μ§€ μ™„μ„±) 
        "nurse-salary"          # κ°„νΈμ‚¬ κΈ‰μ—¬ μμΈ΅ (μƒμ„Ένμ΄μ§€ μ™„μ„±)
    ]
    
    # === μ™„μ„±λ LLM μ¤ν‚¬ λ©λ΅ ===
    COMPLETE_LLM_SKILLS: List[str] = [
        "langchain",    # LangChain (μƒμ„Ένμ΄μ§€ μ™„μ„±)
        "rag",          # RAG (μƒμ„Ένμ΄μ§€ μ™„μ„±)
        "vector-db",    # Vector DB (μƒμ„Ένμ΄μ§€ μ™„μ„±)
        "openai",       # OpenAI (μƒμ„Ένμ΄μ§€ μ™„μ„±)
        "fine-tuning",  # Fine-tuning (μƒμ„Ένμ΄μ§€ μ™„μ„±)
        "postgresql"    # PostgreSQL (μƒμ„Ένμ΄μ§€ μ™„μ„±)
    ]
    
    @staticmethod
    def get_toss_job_context() -> str:
        """
        ν† μ¤ ML Engineer μ±„μ©κ³µκ³  μ™„μ „ν• μ»¨ν…μ¤νΈ λ°ν™
        λ¨λ“  GPT μ”μ²­ μ‹ ν¬ν•¨ν•μ—¬ ν† μ¤ μ”κµ¬μ‚¬ν•­μ— λ§λ” λ‹µλ³€ μƒμ„±
        """
        return """=== ν† μ¤ ML Engineer [μ‚°μ—…κΈ°λ¥μ”μ›/μ „λ¬Έμ—°κµ¬μ”μ›] μ±„μ©κ³µκ³  ===

π“ νμ‚¬: ν† μ¤ (Toss)
π“ μ§κΈ‰: μ •κ·μ§  
π“ ν€ νΉμ„±: λ‹¤μ–‘ν• μ‚¬μ—…λ¶€ λ° ν€μ— μ†ν•μ—¬ ν† μ¤μ λ‹¤μ–‘ν• λ¬Έμ λ¥Ό λ¨Έμ‹ λ¬λ‹μ„ ν†µν•΄ λΉ λ¥΄κ² ν•΄κ²°ν•κ³  μλ™ν™”

π― ν€μ μ—­ν• :
- ML κΈ°μ μ„ ν†µν•΄ μ—¬λ¬ λΉ„μ¦λ‹μ¤ λ„λ©”μΈμ—μ„ λ°μƒν•λ” λ¬Έμ  ν•΄κ²°
- ML κΈ°λ°μΌλ΅ κ³µν†µν™”λ κΈ°μ  μ ν’λ“¤μ„ ν† μ¤ν€μ— μ κ³µ  
- μΈν„°λ·°λ¥Ό ν†µν•΄ ν›„λ³΄μμ κ°•μ κ³Ό κ²½ν—μ„ κ³ λ ¤ν• λ„λ©”μΈ λ° κ³Όμ μ— λ°°μΉ

π’Ό μ£Όμ” μ—…λ¬΄ μμ—­ (6κ°):

1. π“‹ General
   - μ¶”μ², μ΄μƒ νƒμ§€, μμ—°μ–΄ μ²λ¦¬, AutoML λ“± λ‹¤μ–‘ν• κ³Όμ 
   - μƒλ΅μ΄ λ¬Έμ  μ ν•μ„ νƒμƒ‰ν•κ³  μ‹¤ν—

2. π― μ¶”μ² (Recommendation) 
   - ν† μ¤μ λ‹¤μ–‘ν• λ„λ©”μΈ(Ads, μ»¤λ¨Έμ¤, Home λ“±)
   - μ¶”μ² μ‹μ¤ν…κ³Ό λ°μ‘ μμΈ΅ λ¨λΈ κ°λ°
   - μ‚¬μ©μμ™€ μ½ν…μΈ , μ„λΉ„μ¤, κ΄‘κ³  κ°„μ μ—°κ²° μµμ ν™”

3. π“Ά Ads (κ΄‘κ³ )
   - λ‹¤μ–‘ν• κ΄‘κ³  μ§€λ©΄κ³Ό μ‚¬μ©μ μ ‘μ 
   - κ΄‘κ³  νΌλ„ μ „λ° μµμ ν™”λ¥Ό μ„ν• μμΈ΅ λ¨λΈ
   - μμ‚¬κ²°μ • λ΅μ§ μ„¤κ³„

4. π”§ Platform  
   - λ‹¤μ–‘ν• ML μ”κµ¬μ‚¬ν•­μ„ μ•μ „ν•κ³  λΉ λ¥΄κ² μ‹¤ν— λ°λ³µ
   - λ°°ν¬ ν”λ«νΌ λ° Kubernetes μΈν”„λΌ κµ¬μ¶•
   - ML ν€μ— κΈ°μ  μ ν’ μ κ³µ

5. π” κ²€μƒ‰ (Search)
   - μ‹¤μ‹κ°„ λ€μ©λ‰ λ°μ΄ν„° μ²λ¦¬
   - κ²€μƒ‰ μΈν”„λΌ μ΄μ  
   - κ²€μƒ‰ ν’μ§ κ°μ„ 
   - κ²€μƒ‰ ν”λ«νΌ μ„¤κ³„ν•κ³  μ΄μ
   - κ³ κ° κ²½ν— κ°μ„ 

6. π¤– AI β­β­β­ 
   - LLM, RAG, λ©€ν‹°λ¨λ‹¬ λ“± λ‹¤μ–‘ν• AI κΈ°μ  ν™μ©
   - λ¬Έμ λ¥Ό μ •μν•κ³  κΈ°μ μ μΌλ΅ μ ‘κ·Όν•λ” λ°©μ‹ μμ²΄λ¥Ό μ„¤κ³„

β… μκ²© μ”κ±΄ (ν† μ¤κ°€ μ›ν•λ” μΈμ¬):
1. λ¨Έμ‹ λ¬λ‹μ— λ€ν• κΉμ΄ μλ” μ΄ν•΄ + λ‹¤μ–‘ν• λΉ„μ¦λ‹μ¤ λ¬Έμ  μ μ© κ²½ν—
2. SQL λ° Hadoop, Spark λ“± λΉ…λ°μ΄ν„° ν”λ«νΌ κ²½ν—  
3. λ¨λΈ μ„¤κ³„/κ°λ° β†’ μ‹¤μ  μ„λΉ„μ¤ μ μ© β†’ κ²°κ³Ό λ¶„μ„ μ „ κ³Όμ • κ²½ν—
4. PyTorch, TensorFlow, XGBoost, LightGBM λ“± μ£Όμ” ML λΌμ΄λΈλ¬λ¦¬ μ‹¤λ¬΄ κ²½ν—
5. μƒλ΅μ΄ λ¬Έμ μ— λΉ λ¥΄κ² λ°μ… + ν•„μ” μ—­λ‰ μ¤μ¤λ΅ ν•™μµν•μ—¬ ν•΄κ²°

π“„ μ΄λ ¥μ„ ν‰κ°€ κΈ°μ¤€:
- λ¨Έμ‹ λ¬λ‹ μ•κ³ λ¦¬μ¦ μ§μ ‘ κ°λ° + μ΄μ μ μ© κ²½ν— β†’ μ‚¬μ© κΈ°μ κ³Ό κ·Έλ΅ μΈν• λ³€ν™” λ…μ‹
- ν€ κ²°κ³ΌλΏ μ•„λ‹λΌ λ³ΈμΈμ΄ μ£Όλ„μ μΌλ΅ κΈ°μ—¬ν• λ¶€λ¶„ κµ¬μ²΄μ  λ…μ‹  
- κ²½ν—μ΄ μ μ–΄λ„ β†’ λ¬Έμ  μ •μν•κ³  ν•΄κ²°ν• κ³Όμ •μ΄ μ λ“λ¬λ‚λ©΄ μΆ‹μ€ μΈμƒ

π”¥ ν† μ¤ ML Engineerμ ν•µμ‹¬ μ² ν•™:
"λ‹¨μν• λ¨λΈλ§λ§ ν•λ” κ²ƒμ΄ μ•„λ‹, λΉ„μ¦λ‹μ¤μ— μ„ν©νΈλ¥Ό λ‚΄λ” μ—­ν• "

ν† μ¤λ§μ νΉλ³„ν• μ :
- λ¨λΈλ§ κ·Έ μ΄μƒμ„ ν•λ‹¤
- μ΄μ „: "μ£Όμ–΄μ§„ λ¨λΈμ— λ°μ΄ν„° λ„£κ³  μ„±λ¥ ν‰κ°€"  
- ν„μ¬: "μ§‘κ³„λμ§€ μ•λ” λ°μ΄ν„°λ¥Ό μ–΄λ–»κ² λ¨λΈμ— λ…Ήμ—¬λ‚Όμ§€ κ³ λ―Ό"
- κΈμµ λ°μ΄ν„° λ¶„μ„μ„ λ„μ–΄μ„ β†’ μ μ € μ΄ν•΄ λ°”νƒ•μΌλ΅ μνΌ μ•± μ΄μμ— μ„ν©νΈ

π― μ±„μ© ν”„λ΅μ„Έμ¤:
μ„λ¥ μ ‘μ β†’ 1μ°¨ μ§λ¬΄ μΈν„°λ·°(μ½”λ”©) β†’ 2μ°¨ μ§λ¬΄ μΈν„°λ·° β†’ λ¬Έν™”μ ν•©μ„± μΈν„°λ·° β†’ λ νΌλ°μ¤μ²΄ν¬ β†’ μ²μ° ν‘μ β†’ μµμΆ… ν•©κ²©

=== μ±„μ©λ‹΄λ‹Ήμ λ§μΈλ“μ…‹ ===
λ‹Ήμ‹ μ€ ν† μ¤ ML Engineer μ±„μ©λ‹΄λ‹Ήμλ΅μ„ λ‹¤μμ„ μ¤‘μ”μ‹ν•©λ‹λ‹¤:
- λΉ„μ¦λ‹μ¤ μ„ν©νΈλ¥Ό λ‚Έ μ‹¤μ  κ²½ν—
- LLM/RAG/λ©€ν‹°λ¨λ‹¬ AI κΈ°μ  ν™μ© λ¥λ ¥
- μ¶”μ²μ‹μ¤ν…, λ€μ©λ‰ λ°μ΄ν„° μ²λ¦¬ κ²½ν—
- λ¬Έμ  μ •μλ¶€ν„° ν•΄κ²°κΉμ§€ μ£Όλ„μ  κΈ°μ—¬
- μ‹¤μ  μ„λΉ„μ¤ μ μ©κ³Ό κ²°κ³Ό λ¶„μ„ κ²½ν—"""

    @staticmethod  
    def get_company_context(company: str) -> str:
        """νμ‚¬λ³„ μ±„μ© μ»¨ν…μ¤νΈ λ°ν™"""
        if company == "toss":
            return Config.get_toss_job_context()
        else:
            return """=== μΌλ° AI/ML μ—”μ§€λ‹μ–΄ μ±„μ© μƒν™© ===
κΈ°μ μ  μ—­λ‰κ³Ό λ¬Έμ  ν•΄κ²° λ¥λ ¥μ„ μΆ…ν•©μ μΌλ΅ ν‰κ°€ν•λ” μΌλ°μ μΈ λ©΄μ ‘ μƒν™©μ…λ‹λ‹¤.
λ‹¤μ–‘ν• ν”„λ΅μ νΈ κ²½ν—κ³Ό κΈ°μ  μ¤νƒμ„ κ· ν•μκ² μ–΄ν•„ν•λ” κ²ƒμ΄ μ¤‘μ”ν•©λ‹λ‹¤."""

    @classmethod
    def validate_config(cls):
        """μ„¤μ • μ ν¨μ„± κ²€μ‚¬"""
        if not cls.OPENAI_API_KEY:
            raise ValueError("OPENAI_API_KEYκ°€ μ„¤μ •λμ§€ μ•μ•μµλ‹λ‹¤")
        if not cls.PORTFOLIO_BASE_URL:
            raise ValueError("PORTFOLIO_BASE_URLμ΄ μ„¤μ •λμ§€ μ•μ•μµλ‹λ‹¤")